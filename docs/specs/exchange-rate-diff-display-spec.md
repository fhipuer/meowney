# USD 자산 환율 변동 표시 기능 스펙

## 1. 개요

### 배경 및 목적
- USD 자산의 매수 시점 환율과 현재 환율의 차이를 자산 목록에서 확인하고 싶음
- 현재는 자산 수정 폼에서만 매수 환율을 확인 가능
- 환율 변동으로 인한 추가 손익을 한눈에 파악할 수 있도록 개선

### 핵심 가치 제안
- USD 자산의 환율 변동 정보를 자산 목록에서 즉시 확인
- 수익률과 함께 환율 변동률을 비교하여 투자 성과 분석 용이

---

## 2. 요구사항

### 기능 요구사항
| ID | 요구사항 | 우선순위 |
|----|----------|----------|
| FR-01 | USD 자산 행에 환율 비교 정보 표시 | 필수 |
| FR-02 | 표시 형식: `FX: 1,350→1,430 (+5.9%)` | 필수 |
| FR-03 | 매수 환율 미입력 시 환율 정보 숨김 | 필수 |
| FR-04 | 한국식 색상 (빨강=상승, 파랑=하락) | 필수 |
| FR-05 | 프라이버시 모드: 변동률만 표시 | 필수 |
| FR-06 | 모바일: 압축 표시 (`환율+5.9%`) | 필수 |

### 비기능 요구사항
| ID | 요구사항 |
|----|----------|
| NFR-01 | 기존 성능 유지 (추가 API 호출 없음) |
| NFR-02 | 반응형 디자인 (모바일/데스크톱) |
| NFR-03 | 다크모드 지원 |

---

## 3. 사용자 시나리오

### 시나리오 1: 환율 상승 확인
1. 사용자가 `/assets` 페이지 접속
2. USD 자산 목록에서 "미국 금 광산 ETF" 확인
3. 수익률 `+19.22%` 옆에 `FX: 1,350→1,430 (+5.9%)` 표시 확인
4. 빨간색으로 표시되어 환율 상승(이득)임을 인지

### 시나리오 2: 매수 환율 미입력
1. 매수 환율이 입력되지 않은 USD 자산 확인
2. 해당 자산에는 환율 정보가 표시되지 않음

### 시나리오 3: 프라이버시 모드
1. 프라이버시 모드 활성화
2. USD 자산의 환율 정보가 `FX: +5.9%`로만 표시 (환율 숫자 숨김)

---

## 4. 기술 설계

### 아키텍처
- **프론트엔드만 수정** (백엔드 변경 없음)
- 기존 API 응답 데이터 활용:
  - `asset.purchase_exchange_rate`: 매수 시점 환율
  - `asset.current_exchange_rate`: 현재 환율 (API에서 이미 제공)

### 데이터 흐름
```
API 응답 (Asset)
  ├── purchase_exchange_rate: 1350
  └── current_exchange_rate: 1430
          ↓
프론트엔드 계산
  ├── 변동률: (1430 - 1350) / 1350 * 100 = 5.93%
  └── 변동액: 1430 - 1350 = 80
          ↓
UI 렌더링
  └── FX: 1,350→1,430 (+5.9%)
```

### 수정 파일
- `frontend/src/components/assets/AssetList.tsx`

---

## 5. UI/UX 설계

### 데스크톱 레이아웃
```
┌─────────────────────────────────────────────────────────────┐
│ [ETF] 미국 금 광산 ETF     $3,387 / ₩4,839,574              │
│       GDX | USD            +19.22%  FX: 1,350→1,430 (+5.9%) │
│       31주 × $97                    ↑ 작은 폰트, 빨간색      │
└─────────────────────────────────────────────────────────────┘
```

### 모바일 레이아웃
```
┌─────────────────────────────────┐
│ [ETF] 미국 금 광산 ETF          │
│       $3,387 / ₩4,839,574       │
│       +19.22%  환율+5.9%        │
│                ↑ 압축 표시       │
└─────────────────────────────────┘
```

### 프라이버시 모드
```
데스크톱: FX: +5.9%
모바일: 환율+5.9%
```

### 색상 규칙
| 조건 | 색상 |
|------|------|
| 환율 상승 (이득) | 빨간색 (`text-red-500`) |
| 환율 하락 (손실) | 파란색 (`text-blue-500`) |
| 변동 없음 | 회색 (`text-muted-foreground`) |

### 표시 조건
| 조건 | 표시 |
|------|------|
| `currency !== 'USD'` | 표시 안 함 |
| `purchase_exchange_rate === null` | 표시 안 함 |
| `purchase_exchange_rate` 있음 | 환율 비교 표시 |

---

## 6. 보안 고려사항

- 환율 정보는 민감 정보가 아니므로 특별한 보안 처리 불필요
- 프라이버시 모드에서 환율 숫자 마스킹 처리 (변동률은 표시)

---

## 7. 테스트 계획

### 테스트 케이스
| ID | 케이스 | 예상 결과 |
|----|--------|----------|
| TC-01 | USD 자산, 매수환율 있음, 환율 상승 | `FX: 1,350→1,430 (+5.9%)` 빨간색 |
| TC-02 | USD 자산, 매수환율 있음, 환율 하락 | `FX: 1,450→1,430 (-1.4%)` 파란색 |
| TC-03 | USD 자산, 매수환율 없음 | 환율 정보 미표시 |
| TC-04 | KRW 자산 | 환율 정보 미표시 |
| TC-05 | 프라이버시 모드 ON | `FX: +5.9%` (숫자 숨김) |
| TC-06 | 모바일 화면 | `환율+5.9%` 압축 표시 |
| TC-07 | 다크모드 | 색상 정상 표시 |

---

## 8. 제약사항 및 가정

### 제약사항
- `/assets` 페이지에만 적용 (대시보드 등 다른 페이지 제외)
- 백엔드 수정 없이 프론트엔드만 수정

### 가정
- `current_exchange_rate`는 API 응답에 항상 포함됨
- `purchase_exchange_rate`는 사용자 입력에 따라 null일 수 있음

---

## 9. 미결정 사항 / 추후 논의 필요

- 없음 (인터뷰 완료)
